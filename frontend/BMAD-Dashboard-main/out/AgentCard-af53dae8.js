import{r as d,j as t,a as m,b}from"./index-7408bec3.js";import{C as A,P as N,S as I}from"./square-14761259.js";const f={validateApiResponse:(e,r)=>{if(!e||typeof e!="object")return console.warn("Invalid API response: data is not an object"),!1;for(const a of r)if(!(a in e))return console.warn(`Invalid API response: missing key '${a}'`),!1;return!0},validateArray:(e,r)=>{if(!Array.isArray(e))return console.warn("Expected array but got:",typeof e),!1;if(r){for(let a=0;a<e.length;a++)if(!r(e[a]))return console.warn(`Invalid array item at index ${a}:`,e[a]),!1}return!0},validateObject:(e,r=[])=>{if(!e||typeof e!="object")return console.warn("Invalid object:",e),!1;for(const a of r)if(!(a in e))return console.warn(`Missing required object key: ${a}`),!1;return!0},validateString:(e,r=0)=>typeof e!="string"?(console.warn("Expected string but got:",typeof e),!1):e.length<r?(console.warn(`String too short: ${e.length} < ${r}`),!1):!0},g="http://localhost:5001/api",T=()=>{const[e,r]=d.useState([]),[a,u]=d.useState(!0),[x,p]=d.useState(null),[c,h]=d.useState(0),v=Array.isArray(e)?e:[],i=d.useCallback(async()=>{try{u(!0),p(null);const n=new AbortController,s=setTimeout(()=>n.abort(),1e4),o=await fetch(`${g}/agents`,{method:"GET",headers:{"Content-Type":"application/json"},signal:n.signal});if(clearTimeout(s),!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const l=await o.json();if(!f.validateApiResponse(l,["agents"])){console.warn("Invalid agents API response structure"),r([]);return}f.validateArray(l.agents,j=>f.validateObject(j,["id","name","status"]))?(r(l.agents),h(0)):(console.warn("Invalid agents array structure"),r([]))}catch(n){const s=n instanceof Error?n.message:"Failed to fetch agents";p(s),console.error("Error fetching BMAD agents:",n),h(o=>o+1),r([])}finally{u(!1)}},[]),y=d.useCallback(async n=>{if(!f.validateString(n,1))return{success:!1,message:"Invalid agent ID"};try{const s=new AbortController,o=setTimeout(()=>s.abort(),5e3),l=await fetch(`${g}/agents/${n}/start`,{method:"POST",headers:{"Content-Type":"application/json"},signal:s.signal});if(clearTimeout(o),!l.ok)throw new Error(`Failed to start agent: ${l.status}`);return await i(),{success:!0,message:"Agent started successfully"}}catch(s){const o=s instanceof Error?s.message:"Failed to start agent";return console.error("Error starting agent:",s),{success:!1,message:o}}},[i]),w=d.useCallback(async n=>{if(!f.validateString(n,1))return{success:!1,message:"Invalid agent ID"};try{const s=new AbortController,o=setTimeout(()=>s.abort(),5e3),l=await fetch(`${g}/agents/${n}/stop`,{method:"POST",headers:{"Content-Type":"application/json"},signal:s.signal});if(clearTimeout(o),!l.ok)throw new Error(`Failed to stop agent: ${l.status}`);return await i(),{success:!0,message:"Agent stopped successfully"}}catch(s){const o=s instanceof Error?s.message:"Failed to stop agent";return console.error("Error stopping agent:",s),{success:!1,message:o}}},[i]);return d.useEffect(()=>{i();const n=setInterval(i,15e3);return()=>clearInterval(n)},[i]),{agents:v,loading:a,error:x,retryCount:c,fetchAgents:i,startAgent:y,stopAgent:w}},$=({agent:e,onStart:r,onStop:a,onClick:u})=>{const x=c=>{switch(c){case"active":return"bg-green-500";case"stopped":return"bg-gray-500";case"error":return"bg-red-500";default:return"bg-yellow-500"}},p=c=>{switch(c){case"active":return"Actief";case"stopped":return"Gestopt";case"error":return"Kritiek";case"idle":return"Inactief";default:return"Inactief"}};return t.jsxs("div",{className:m("bg-card rounded-2xl p-6 shadow-lg border border-border","hover:shadow-xl transition-all duration-200","relative agent-card",u&&"cursor-pointer"),onClick:()=>u==null?void 0:u(e),children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:m("w-3 h-3 rounded-full",x(e.status))}),t.jsx("span",{className:m("text-sm font-medium",e.status==="active"?"text-green-600":e.status==="stopped"?"text-gray-600":e.status==="error"?"text-red-600":"text-yellow-600"),children:p(e.status)})]}),t.jsxs("div",{className:"flex items-center space-x-1",children:[t.jsx(b,{className:"w-4 h-4 text-muted-foreground"}),t.jsxs("span",{className:"text-sm text-muted-foreground",children:[e.performance,"%"]})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-card-foreground mb-1",children:e.name}),t.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:e.type}),t.jsxs("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[t.jsx(A,{className:"w-3 h-3"}),t.jsx("span",{children:e.last_activity})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[t.jsx("span",{className:"text-muted-foreground",children:"Prestatie"}),t.jsxs("span",{className:"text-card-foreground font-medium",children:[e.performance,"%"]})]}),t.jsxs("div",{className:"w-full bg-muted rounded-full h-2 relative overflow-hidden",children:[t.jsx("div",{className:m("h-2 rounded-full transition-all duration-300",e.performance>100?"bg-red-500":"bg-green-500"),style:{width:`${Math.min(e.performance,100)}%`,...e.performance>100&&{boxShadow:"0 0 12px rgba(239, 68, 68, 0.8)",filter:"brightness(1.2)"}}}),e.performance>100&&t.jsx("div",{className:"absolute right-0 top-0 h-2 w-1 bg-red-400 rounded-r-full"})]}),e.performance>100&&t.jsxs("div",{className:"text-xs text-red-600 mt-1 flex items-center",children:[t.jsx(b,{className:"w-3 h-3 mr-1"}),"Kritiek: ",e.performance,"% performance"]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("button",{onClick:c=>{c.stopPropagation(),r(e.id)},disabled:e.status==="active",className:m("flex items-center space-x-1 px-3 py-2 rounded-lg text-sm",e.status==="active"?"bg-green-500 text-white cursor-not-allowed":"bg-primary text-primary-foreground hover:bg-primary/90"),children:[t.jsx(N,{className:"w-3 h-3"}),t.jsx("span",{children:"Start"})]}),t.jsxs("button",{onClick:c=>{c.stopPropagation(),a(e.id)},disabled:e.status==="stopped",className:m("flex items-center space-x-1 px-3 py-2 rounded-lg text-sm",e.status==="stopped"?"bg-gray-500 text-white cursor-not-allowed":"bg-destructive text-destructive-foreground hover:bg-destructive/90"),children:[t.jsx(I,{className:"w-3 h-3"}),t.jsx("span",{children:"Stop"})]})]})]})};export{$ as A,T as u};
//# sourceMappingURL=AgentCard-af53dae8.js.map
