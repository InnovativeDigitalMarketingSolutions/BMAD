import{c as I,r as s,u as H,j as e,a as i,R as $,C as z,H as J,U as Z}from"./index-7408bec3.js";import{u as K,A as Q}from"./AgentCard-af53dae8.js";import{W as V,u as X,T as Y}from"./useSystemMetrics-d9e7f047.js";import"./square-14761259.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=I("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=I("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=I("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=I("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),ne=(r={})=>{const{url:a="ws://localhost:5001/ws",autoReconnect:d=!0,reconnectInterval:m=3e3,maxReconnectAttempts:g=5,fallbackToPolling:n=!0,pollingInterval:h=3e3}=r,[P,x]=s.useState(!1),[R,f]=s.useState(!1),[D,N]=s.useState(null),[W,t]=s.useState(null),[o,u]=s.useState("disconnected"),[B,T]=s.useState(0),[S,U]=s.useState(!1),p=s.useRef(null),A=s.useRef(null),b=s.useRef(null),l=s.useRef(!0),F=s.useCallback(()=>{p.current&&(p.current.close(),p.current=null),A.current&&(clearTimeout(A.current),A.current=null),b.current&&(clearInterval(b.current),b.current=null)},[]),C=s.useCallback(()=>{if(!n||!l.current)return;console.log("Starting polling fallback..."),U(!0),u("connecting");const y=async()=>{if(l.current)try{const c=new AbortController,w=setTimeout(()=>c.abort(),5e3);console.log("Polling API endpoint: http://localhost:5001/api-proxy/agents");const k=await fetch("http://localhost:5001/api-proxy/agents",{signal:c.signal,headers:{"Content-Type":"application/json"}});if(clearTimeout(w),k.ok&&l.current){const j=await k.json();console.log("Polling successful, data received:",j),j&&(j.agents||j.error)?(N({type:"agents",data:j,timestamp:Date.now()}),u("connected"),t(null)):(console.warn("Polling failed, invalid data structure:",j),u("disconnected"),t("Invalid API response structure"))}else console.warn("Polling failed, response not ok:",k.status),u("disconnected"),t("API response not ok")}catch(c){l.current&&(console.warn("Polling fallback error:",c),t("Connection failed, using polling fallback"),u("error"))}};y(),b.current=setInterval(y,h)},[n,h]),L=s.useCallback(()=>{b.current&&(clearInterval(b.current),b.current=null),U(!1)},[]),v=s.useCallback(()=>{var y;if(l.current&&((y=p.current)==null?void 0:y.readyState)!==WebSocket.OPEN){f(!0),u("connecting"),t(null);try{const c=new WebSocket(a);p.current=c,c.onopen=()=>{l.current&&(x(!0),f(!1),u("connected"),T(0),t(null),L())},c.onmessage=w=>{if(l.current)try{const k=JSON.parse(w.data);N(k)}catch(k){console.error("Failed to parse WebSocket message:",k)}},c.onclose=()=>{l.current&&(x(!1),f(!1),u("disconnected"),d&&B<g&&l.current?(T(w=>w+1),A.current=setTimeout(()=>{l.current&&v()},m)):n&&!S&&l.current&&(console.log("WebSocket failed, starting polling fallback"),C()))},c.onerror=()=>{l.current&&(console.warn("WebSocket error, falling back to polling"),t("WebSocket error, using polling fallback"),u("error"),f(!1),n&&!S&&(console.log("WebSocket error, starting polling fallback"),C()))}}catch(c){if(!l.current)return;console.warn("Failed to create WebSocket, using polling fallback:",c),t("WebSocket not available, using polling fallback"),u("error"),f(!1),n&&!S&&(console.log("WebSocket creation failed, starting polling fallback"),C())}}},[a,d,m,g,B,n,S,C,L]),M=s.useCallback(()=>{F(),l.current&&(x(!1),f(!1),u("disconnected"))},[F]),q=s.useCallback(y=>{var c;((c=p.current)==null?void 0:c.readyState)===WebSocket.OPEN?p.current.send(JSON.stringify(y)):console.warn("WebSocket is not connected, cannot send message")},[]),G=s.useCallback(()=>{M(),T(0),v()},[M,v]);return s.useEffect(()=>(l.current=!0,v(),()=>{l.current=!1,M()}),[v,M]),{isConnected:P,isConnecting:R,lastMessage:D,sendMessage:q,reconnect:G,error:W,connectionStatus:o}},ae=()=>{const{isDark:r,toggle:a}=H();return e.jsxs("button",{onClick:a,className:i("relative inline-flex h-10 w-20 items-center rounded-full","bg-gradient-to-r from-slate-200 to-slate-300 dark:from-slate-700 dark:to-slate-600","hover:from-slate-300 hover:to-slate-400 dark:hover:from-slate-600 dark:hover:to-slate-500","transition-all duration-300 ease-in-out","focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:ring-offset-2","focus:ring-offset-background shadow-md"),"aria-label":"Toggle theme",children:[e.jsx("span",{className:i("inline-block h-8 w-8 transform rounded-full","bg-gradient-to-br from-white to-slate-100 dark:from-slate-800 dark:to-slate-900","shadow-lg border border-slate-200 dark:border-slate-600","transition-all duration-300 ease-in-out",r?"translate-x-10":"translate-x-1")}),e.jsx(re,{className:"absolute left-2 h-4 w-4 text-amber-500 dark:text-amber-400"}),e.jsx(te,{className:"absolute right-2 h-4 w-4 text-slate-600 dark:text-slate-300"})]})},oe=({status:r,isPolling:a=!1,className:d})=>{const g=(()=>{switch(r){case"connected":return{icon:V,color:"text-green-500",title:a?"Polling Mode":"Connected"};case"connecting":return{icon:$,color:"text-yellow-500",title:"Connecting"};case"disconnected":return{icon:se,color:"text-gray-500",title:"Disconnected"};case"error":return{icon:ee,color:"text-red-500",title:"Connection Error"}}})(),n=g.icon;return e.jsx("div",{className:i("p-1 rounded-full",d),title:g.title,children:e.jsx(n,{className:i("w-4 h-4",g.color,r==="connecting"&&"animate-spin")})})},O={cpu:{warning:70,critical:90},memory:{warning:80,critical:95}},_=(r,a)=>r>=a.critical?"critical":r>=a.warning?"warning":"normal",le=r=>{switch(r){case"critical":return"text-red-500 bg-red-500/10";case"warning":return"text-yellow-500 bg-yellow-500/10";default:return"text-green-500 bg-green-500/10"}},ce=r=>{switch(r){case"critical":return"ðŸ”´";case"warning":return"ðŸŸ¡";default:return"ðŸŸ¢"}},ie=({value:r,status:a})=>e.jsx("div",{className:"w-full bg-muted rounded-full h-2 mb-2",children:e.jsx("div",{className:i("h-2 rounded-full transition-all duration-300",a==="critical"?"bg-red-500":a==="warning"?"bg-yellow-500":"bg-green-500"),style:{width:`${Math.min(r,100)}%`}})}),E=({icon:r,title:a,value:d,status:m,description:g,badge:n,badgeColor:h})=>e.jsxs("div",{className:i("bg-card rounded-2xl p-6 shadow-lg border","border-border hover:shadow-xl transition-all duration-200"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:i("p-3 rounded-lg",le(m)),children:e.jsx(r,{className:"w-8 h-8"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:i("px-3 py-1 rounded-full text-xs font-medium",h),children:n}),e.jsx("span",{className:"text-lg",children:ce(m)})]})]}),e.jsx("h3",{className:"text-lg font-semibold text-card-foreground mb-2",children:a}),e.jsx("div",{className:"text-3xl font-bold text-card-foreground mb-2",children:d}),e.jsx("div",{className:"text-sm text-muted-foreground mb-3",children:g}),typeof d=="number"&&e.jsx(ie,{value:d,status:m})]}),de=s.memo(()=>{const{agents:r,loading:a,error:d,startAgent:m,stopAgent:g}=K(),{metrics:n}=X(),{connectionStatus:h,isConnected:P}=ne({url:"ws://localhost:5001/ws",autoReconnect:!0,fallbackToPolling:!0,pollingInterval:1e4}),[x,R]=s.useState("all"),f=s.useMemo(()=>Array.isArray(r)?x==="all"?r:r.filter(t=>t&&t.status===x):[],[r,x]),D=s.useMemo(()=>Array.isArray(r)?["all",...[...new Set(r.filter(o=>o&&o.status).map(o=>o.status))]]:["all"],[r]),N=async t=>{if(!t){console.error("Invalid agent ID provided");return}try{const o=await m(t);o.success||console.error("Failed to start agent:",o.message)}catch(o){console.error("Error starting agent:",o)}},W=async t=>{if(!t){console.error("Invalid agent ID provided");return}try{const o=await g(t);o.success||console.error("Failed to stop agent:",o.message)}catch(o){console.error("Error stopping agent:",o)}};return e.jsx("div",{className:i("min-h-screen transition-colors duration-200","bg-background text-foreground"),children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:i("bg-card rounded-2xl p-8 shadow-lg border","border-border h-32"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-card-foreground",children:"BMAD Dashboard v1.0"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Live Monitoring"})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(oe,{status:h,isPolling:!P&&h==="connected",className:"p-2 rounded-lg border border-border"}),e.jsx(ae,{})]})]})})}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:i("bg-card rounded-2xl p-8 shadow-lg border","border-border"),children:[e.jsx("div",{className:"flex-shrink-0 mb-6",children:e.jsx("h2",{className:"text-xl font-semibold text-card-foreground",children:"BMAD Agent Systeem Gezondheid"})}),n&&n.system_health?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(E,{icon:z,title:"Agent CPU Gebruik",value:`${parseInt(n.system_health.cpu_usage)||0}%`,status:_(parseInt(n.system_health.cpu_usage)||0,O.cpu),description:"Gemiddeld CPU gebruik van alle agents",badge:"Agent CPU",badgeColor:"bg-blue-500 text-white"}),e.jsx(E,{icon:J,title:"Agent Geheugen",value:`${parseInt(n.system_health.memory_usage)||0}%`,status:_(parseInt(n.system_health.memory_usage)||0,O.memory),description:"Gemiddeld geheugen gebruik van alle agents",badge:"Agent RAM",badgeColor:"bg-green-500 text-white"}),e.jsx(E,{icon:Y,title:"Agent Success Rate",value:`${n.system_health.agent_success_rate||0}%`,status:_(n.system_health.agent_success_rate||0,{warning:70,critical:50}),description:"Percentage succesvolle agent taken",badge:"Success",badgeColor:"bg-purple-500 text-white"})]}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading system health data..."})})]})}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:i("bg-card rounded-2xl p-8 shadow-lg border","border-border"),children:[e.jsxs("div",{className:"flex-shrink-0 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-card-foreground",children:"BMAD Agents"}),d&&e.jsxs("div",{className:"text-sm text-destructive",children:["Error loading agents: ",d]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:D.map(t=>e.jsx("button",{onClick:()=>R(t),className:i("px-3 py-1 rounded-lg text-sm font-medium transition-all duration-200",x===t?"bg-primary text-primary-foreground shadow-md":"bg-secondary text-secondary-foreground hover:bg-secondary/80"),children:t==="all"?"All Status":t.charAt(0).toUpperCase()+t.slice(1)},t))})]}),a?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-h-96 overflow-y-auto",children:[1,2,3,4,5,6].map(t=>e.jsxs("div",{className:i("bg-muted rounded-xl p-6 animate-pulse"),children:[e.jsx("div",{className:"h-4 bg-muted-foreground/20 rounded mb-4"}),e.jsx("div",{className:"h-3 bg-muted-foreground/20 rounded mb-2"}),e.jsx("div",{className:"h-3 bg-muted-foreground/20 rounded"})]},t))}):f.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-h-96 overflow-y-auto pr-2",children:f.map(t=>e.jsx(Q,{agent:t,onStart:N,onStop:W},t.id))}):e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Z,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-medium text-card-foreground mb-2",children:"No BMAD Agents Found"}),e.jsx("p",{className:"text-muted-foreground",children:"No agents are currently running. Start some agents to see them here."})]})})]})})]})})}),xe=de;export{xe as BMADDashboard,de as default};
//# sourceMappingURL=BMADDashboard-04984d4b.js.map
