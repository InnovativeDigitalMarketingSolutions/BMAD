{"version":3,"file":"useSystemMetrics-d9e7f047.js","sources":["../../node_modules/lucide-react/dist/esm/icons/trending-up.js","../../node_modules/lucide-react/dist/esm/icons/wifi.js","../../src/hooks/useSystemMetrics.ts"],"sourcesContent":["/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst TrendingUp = createLucideIcon(\"TrendingUp\", [\n  [\"polyline\", { points: \"22 7 13.5 15.5 8.5 10.5 2 17\", key: \"126l90\" }],\n  [\"polyline\", { points: \"16 7 22 7 22 13\", key: \"kwv8wd\" }]\n]);\n\nexport { TrendingUp as default };\n//# sourceMappingURL=trending-up.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Wifi = createLucideIcon(\"Wifi\", [\n  [\"path\", { d: \"M5 13a10 10 0 0 1 14 0\", key: \"6v8j51\" }],\n  [\"path\", { d: \"M8.5 16.5a5 5 0 0 1 7 0\", key: \"sej527\" }],\n  [\"path\", { d: \"M2 8.82a15 15 0 0 1 20 0\", key: \"dnpr2z\" }],\n  [\"line\", { x1: \"12\", x2: \"12.01\", y1: \"20\", y2: \"20\", key: \"of4bc4\" }]\n]);\n\nexport { Wifi as default };\n//# sourceMappingURL=wifi.js.map\n","// System Metrics Hook - Live API data van poort 5001\r\nimport { useState, useEffect, useCallback } from 'react'\r\nimport { BMADMetrics } from '@/types/bmad'\r\n\r\nconst API_BASE = 'http://localhost:5001/api'\r\nconst API_TIMEOUT = 5000 // 5 seconden timeout\r\n\r\ninterface MetricsResponse {\r\n  metrics: BMADMetrics\r\n  timestamp?: string\r\n}\r\n\r\n// Timeout wrapper voor fetch\r\nconst fetchWithTimeout = async (url: string, options: RequestInit = {}, timeout: number = API_TIMEOUT) => {\r\n  const controller = new AbortController()\r\n  const timeoutId = setTimeout(() => controller.abort(), timeout)\r\n  \r\n  try {\r\n    const response = await fetch(url, {\r\n      ...options,\r\n      signal: controller.signal\r\n    })\r\n    clearTimeout(timeoutId)\r\n    return response\r\n  } catch (error) {\r\n    clearTimeout(timeoutId)\r\n    if (error instanceof Error && error.name === 'AbortError') {\r\n      throw new Error('Request timeout - server niet bereikbaar')\r\n    }\r\n    throw error\r\n  }\r\n}\r\n\r\nexport const useSystemMetrics = () => {\r\n  const [metrics, setMetrics] = useState<BMADMetrics | null>(null)\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [retryCount, setRetryCount] = useState(0)\r\n\r\n  const fetchMetrics = useCallback(async () => {\r\n    const startTime = Date.now()\r\n    \r\n    try {\r\n      setLoading(true)\r\n      setError(null)\r\n      \r\n      const response = await fetchWithTimeout(`${API_BASE}/metrics`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n      }, API_TIMEOUT)\r\n      \r\n      if (!response.ok) {\r\n        const errorText = await response.text().catch(() => 'Unknown error')\r\n        throw new Error(`Server error: ${response.status} - ${errorText}`)\r\n      }\r\n      \r\n      const data: MetricsResponse = await response.json()\r\n      \r\n      // Validate response structure\r\n      if (data && data.metrics && data.metrics.system_health) {\r\n        setMetrics(data.metrics)\r\n        setRetryCount(0) // Reset retry count on success\r\n        \r\n        // Log performance metrics only for slow responses\r\n        const responseTime = Date.now() - startTime\r\n        \r\n        if (responseTime > 500) {\r\n          console.warn(`⚠️ Slow API Response: SystemMetrics took ${responseTime}ms`)\r\n        }\r\n      } else {\r\n        console.warn('Invalid metrics response structure:', data)\r\n        throw new Error('Ongeldige data van server ontvangen')\r\n      }\r\n    } catch (err) {\r\n      const errorMessage = err instanceof Error ? err.message : 'Verbinding met server mislukt'\r\n      setError(errorMessage)\r\n      console.error('Error fetching system metrics:', err)\r\n      \r\n      // Increment retry count for exponential backoff\r\n      setRetryCount(prev => prev + 1)\r\n      \r\n      // Don't crash the app, just set null\r\n      setMetrics(null)\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }, [])\r\n\r\n  // Auto-refresh met exponential backoff bij errors\r\n  useEffect(() => {\r\n    fetchMetrics()\r\n    \r\n    // Calculate interval based on retry count (exponential backoff)\r\n    const baseInterval = 15000 // 15 seconds\r\n    const backoffMultiplier = Math.min(Math.pow(2, retryCount), 8) // Max 8x backoff\r\n    const interval = retryCount > 0 ? baseInterval * backoffMultiplier : baseInterval\r\n    \r\n    const timeoutId = setTimeout(fetchMetrics, interval)\r\n    return () => clearTimeout(timeoutId)\r\n  }, [fetchMetrics, retryCount])\r\n\r\n  return {\r\n    metrics,\r\n    loading,\r\n    error,\r\n    retryCount,\r\n    fetchMetrics\r\n  }\r\n} "],"names":["TrendingUp","createLucideIcon","Wifi","API_BASE","API_TIMEOUT","fetchWithTimeout","url","options","timeout","controller","timeoutId","response","error","useSystemMetrics","metrics","setMetrics","useState","loading","setLoading","setError","retryCount","setRetryCount","fetchMetrics","useCallback","startTime","errorText","data","responseTime","err","errorMessage","prev","useEffect","baseInterval","backoffMultiplier","interval"],"mappings":"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","x_google_ignoreList":[0,1]}